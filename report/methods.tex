We will first replicate the results of the original paper~\cite{Wang2025_fish},
then extend the model by introducing parameters to model a non-zero duty cycle.
We will then rerun the experiments with different values for the duty cycle and evaluate how it affects the collective behavior using objective metrics.

\subsection*{Model Description}

The original burstâ€“coast model consists of a repeated cycle:

\begin{enumerate}
    \item \textbf{Heading selection:}
    Before each burst, the fish computes a combination of attraction and alignment values based on selected neighbors.
    \item \textbf{Burst phase (kick):} The fish updates its heading and samples a random kick time and length.
    \item \textbf{Coast phase:} The fish now moves along a straight path for the duration and length of its kick, with an exponentially velocity.
    \item \textbf{Repeat:} Once the fish reaches the end of its coast phase, it immediately selects a new heading and begins a new burst.
\end{enumerate}

\subsection*{Proposed extension}

We will introduce two parameters to model a detailed duty cycle:

\begin{itemize}
    \item $\omega \in [0,1]$: The ratio between the duration of the burst phase and the total duration of both phases.
    \item $n_\omega \in \mathbb{N}$: The amount of decision instants within the burst phase. Increasing this value will approximate a continuous decision making process within the burst phase.
\end{itemize}

In the initial model, $\omega = 0$ and $n_\omega = 1$.
Instead of an immediate impulse at the start of a burst,
a fish's velocity linearly increases for a duration determined by $\omega$.
The acceleration is set so that the velocity at the end of a burst phase would be the same as the velocity at that time if $\omega$ were $0$ and the usual exponential delay was applied from the start.
The burst phase is also evenly split into $n_\omega$ sub-phases, where the start of each sub-phase represents
a decision point for the desired direction of the fish. Similarly to velocity between the start and the end of the entire burst phase, the heading of the fish is linearly interpolated between each sub-phase.
This means that by increasing $n_\omega$, we can get a (biologically inaccurate) model that arbitrarily approximates a continuous motion model, which allows us to study the effects of a limited decision making process on collective behavior.

\subsection*{Simulation Implementation}

The simulation will be implemented in Python using:

\begin{itemize}
    \item \textbf{NumPy} for array-based state storage,
    \item \textbf{Numba} for the inner simulation loop,
    \item \textbf{Matplotlib} for figures, and
    \item \textbf{Pygame} or a similar library for real-time visualization.
\end{itemize}

\subsection*{Evaluation Metrics}

The original model uses three metrics to evaluate its behavior.
The first one is \textit{Group Dispersion}, representing the average square of distance from the barycenter (i.e., how much the fish are spread out in space).
The second one is \textit{Group Polarization}, which is the measure of how varied the headings of different fish are.
Lastly, the \textit{Milling Index} quantifies the degree of how much the fish are swimming around a barycenter in a circular fashion.
We will use the exact same metrics as the original paper with the goal of producing comparable results:

\textbf{Group Dispersion:}
\[
D(t) = \sqrt{\frac{1}{N}\sum_{i=1}^N \|\vec{u}_i(t)-\vec{u}_B(t)\|^2}
\]
where $\vec{u}_i(t)$ refers to position of fish $i$ at time step $t$, $\vec{u}_B(t)$ refers to position of barycentre and $N$ refers to the number of fish.

\textbf{Group Polarization:}
\[
P(t) = \left \| \frac{1}{N} \sum_{i=1}^N 
\frac{v_i(t)}{\|v_i(t)\|} \right\|
\]
where $\vec{v}_i(t)$ refers to the velocity vector of fish $i$ at time step $t$.

\textbf{Milling Index:}
\[
M = \left| \frac{1}{N} \sum_{i=1}^N 
   \sin{(\bar{\theta}_w^i(t))} 
\right|.
\]
where $\bar{\theta}_w^i = \bar{\phi}_i-\bar{\theta}_i$ and $\bar{\phi}_i$ is the angle of the fish's heading and $\bar{\theta}_i$ is the angle of the fish's position, both with respect to the barycentre as the coordinate origin.

These metrics allow for classification of ordered schooling, milling, swarming, and disordered phases.

